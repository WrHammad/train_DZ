<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù‚Ø·Ø§Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ù„Ø§Ù„ | 11 Ø¯ÙŠØ³Ù…Ø¨Ø± 1960</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap');

        :root {
            /* Ù„ÙˆØ­Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„ÙˆØ·Ù†ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
            --primary: #006633;
            --primary-dark: #004d26;
            --primary-light: #e6f2eb;
            --secondary: #D21034;
            --secondary-light: #fff0f2;
            --accent: #f59e0b; /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ Ø°Ù‡Ø¨ÙŠ Ù„Ù„ØªÙ…ÙŠÙŠØ² */
            
            --bg-body: #f8fafc;
            --surface: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            
            --track-bg: #cbd5e1;
            --station-size: 55px; /* ØªÙƒØ¨ÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù…Ø­Ø·Ø§Øª */
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }

        body {
            font-family: 'Cairo', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            margin: 0; padding: 0;
            height: 100vh; height: 100dvh;
            display: flex; flex-direction: column;
            overflow: hidden;
        }

        /* --- 1. Ø§Ù„Ø±Ø£Ø³ (Header) --- */
        header {
            background: var(--surface);
            padding: 10px 20px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
            z-index: 20;
            border-bottom: 3px solid var(--secondary);
            flex-shrink: 0;
        }
        
        .header-title h1 { margin: 0; font-size: 1.1rem; color: var(--primary); font-weight: 900; }
        .header-title small { font-size: 0.8rem; color: var(--text-muted); font-weight: 600; }

        .lives-box {
            background: var(--secondary-light); color: var(--secondary);
            padding: 6px 16px; border-radius: 50px;
            font-weight: 800; font-size: 1rem;
            display: flex; align-items: center; gap: 8px;
            border: 2px solid rgba(210, 16, 52, 0.15);
            box-shadow: 0 2px 5px rgba(210, 16, 52, 0.1);
        }

        /* --- 2. Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Ø·Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù†Ø© (Train Section) --- */
        .train-container {
            background: linear-gradient(180deg, #e0f2fe 0%, #f0f9ff 100%);
            padding: 45px 20px 25px;
            position: relative;
            flex-shrink: 0;
            border-bottom: 1px solid #bfdbfe;
            box-shadow: inset 0 -10px 20px -10px rgba(0,0,0,0.05);
        }

        /* Ø³ÙƒØ© Ø§Ù„Ø­Ø¯ÙŠØ¯ - Ø£ÙƒØ«Ø± ÙˆØ¶ÙˆØ­Ø§Ù‹ */
        .rail-track {
            position: relative;
            height: 18px;
            background: var(--track-bg);
            border-radius: 10px;
            width: 92%; margin: 0 auto;
            display: flex; align-items: center; justify-content: space-between;
            flex-direction: row-reverse; /* 1 on right, 4 on left */
            box-shadow: inset 0 2px 6px rgba(0,0,0,0.15);
            border: 1px solid #94a3b8;
        }
        
        /* Ø¹ÙˆØ§Ø±Ø¶ Ø§Ù„Ø³ÙƒØ© */
        .rail-track::before {
            content: ''; position: absolute; inset: 0;
            background-image: repeating-linear-gradient(90deg, transparent, transparent 12px, rgba(255,255,255,0.6) 12px, rgba(255,255,255,0.6) 16px);
            border-radius: 10px; z-index: 1;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .track-progress {
            position: absolute; right: 0; top: 0; bottom: 0;
            width: 0%; 
            background: linear-gradient(90deg, var(--primary), #22c55e);
            border-radius: 10px; z-index: 2;
            transition: width 1s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.6);
        }

        /* Ø§Ù„Ù…Ø­Ø·Ø§Øª - ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙŠØ¯ */
        .station {
            width: var(--station-size); height: var(--station-size);
            background: var(--surface);
            border: 4px solid #94a3b8;
            border-radius: 50%;
            z-index: 5;
            display: grid; place-items: center;
            font-weight: 900; font-size: 1.3rem; color: #94a3b8;
            position: relative;
            transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 6px 10px rgba(0,0,0,0.1);
        }
        
        /* ØªØ³Ù…ÙŠØ§Øª Ø§Ù„Ù…Ø­Ø·Ø§Øª (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ù„ÙˆØ¶ÙˆØ­) */
        .station::after {
            content: attr(data-label);
            position: absolute; bottom: -25px;
            font-size: 0.7rem; color: var(--text-muted); font-weight: 700;
            white-space: nowrap; opacity: 0.8;
        }

        /* Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø·Ø© Ø§Ù„Ù†Ø´Ø·Ø© */
        .station.active {
            border-color: var(--secondary);
            color: var(--secondary);
            transform: scale(1.25);
            background: #fff;
            box-shadow: 0 0 0 6px rgba(210, 16, 52, 0.15), 0 10px 20px rgba(0,0,0,0.15);
            animation: pulse-ring 2s infinite;
        }
        @keyframes pulse-ring {
            0% { box-shadow: 0 0 0 0px rgba(210, 16, 52, 0.3); }
            70% { box-shadow: 0 0 0 12px rgba(210, 16, 52, 0); }
            100% { box-shadow: 0 0 0 0px rgba(210, 16, 52, 0); }
        }

        /* Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­Ø·Ø© Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© */
        .station.passed {
            background: var(--primary);
            border-color: var(--primary-dark);
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(0, 102, 51, 0.3);
        }
        .station.passed::after { color: var(--primary); }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ø·Ø§Ø± */
        #train-icon {
            position: absolute;
            top: -55px; /* Ø±ÙØ¹ Ø§Ù„Ù‚Ø·Ø§Ø± Ù„ÙŠÙƒÙˆÙ† Ø£ÙˆØ¶Ø­ */
            right: 0;
            font-size: 4rem;
            z-index: 10;
            transform: translateX(50%);
            transition: right 1s cubic-bezier(0.4, 0, 0.2, 1);
            filter: drop-shadow(2px 8px 4px rgba(0,0,0,0.2));
            pointer-events: none;
        }
        /* Ø¯Ø®Ø§Ù† Ø§Ù„Ù‚Ø·Ø§Ø± */
        #train-icon::after {
            content: 'ğŸ’¨'; position: absolute; font-size: 1.8rem; top: 15px; right: -15px;
            opacity: 0; animation: smoke 2s infinite;
        }
        @keyframes smoke { 0% { opacity:0; transform:translate(0,0) scale(0.5); } 50% { opacity:0.7; } 100% { opacity:0; transform:translate(-25px,-25px) scale(1.5); } }

        /* --- 3. ØªØ®Ø·ÙŠØ· Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ù…Ø±Ù† (Main Layout) --- */
        .main-layout {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: #f1f5f9;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ØªØ§ÙŠÙ… Ù„Ø§ÙŠÙ† ÙˆØ§Ù„Ø£Ø³Ø¦Ù„Ø© */
        .timeline-area {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            scroll-behavior: smooth;
        }

        .quest-card {
            background: var(--surface);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            border-right: 5px solid var(--primary);
            animation: slideDown 0.4s ease-out;
        }
        @keyframes slideDown { from {opacity:0; transform:translateY(-10px);} to {opacity:1; transform:translateY(0);} }

        .quest-header { display:flex; justify-content:space-between; margin-bottom:10px; align-items:center; }
        .tag { background: var(--primary-light); color:var(--primary); padding:4px 10px; border-radius:8px; font-size:0.8rem; font-weight:700; }

        /* Ø§Ù„Ø®Ø§Ù†Ø§Øª (Slots) */
        .slots-wrapper { display: flex; flex-direction: column; gap: 12px; }

        .slot {
            background: #f8fafc;
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            min-height: 65px;
            display: flex; align-items: stretch;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }
        .slot.active {
            border-color: var(--primary);
            background: #fff;
            box-shadow: 0 8px 20px -4px rgba(0, 102, 51, 0.15);
            transform: scale(1.02);
            border-style: solid;
            z-index: 2;
        }
        .slot.filled {
            border-style: solid; border-color: #22c55e;
            background: #f0fdf4;
        }
        
        .slot-num {
            width: 50px; display: grid; place-items: center;
            background: #e2e8f0; border-radius: 0 10px 10px 0;
            font-weight: 800; color: #64748b; font-size: 1rem;
            border-left: 1px solid #cbd5e1;
        }
        .slot-text {
            flex: 1; display: grid; place-items: center;
            padding: 8px 15px; text-align: center;
            font-weight: 700; color: var(--primary); font-size: 0.95rem;
            line-height: 1.4;
        }
        /* ØªÙ„Ù…ÙŠØ­ Ø¨ØµØ±ÙŠ Ù„Ù„Ø®Ø§Ù†Ø© Ø§Ù„Ù†Ø´Ø·Ø© */
        .slot.active .slot-text::before {
            content: 'ğŸ‘‡ Ø§Ø¶ØºØ· Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©'; font-size: 0.75rem; color: var(--text-muted); opacity: 0.6;
            position: absolute; top: 2px; left: 10px;
        }

        /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª (Options) */
        .cards-area {
            background: var(--surface);
            padding: 15px 20px 25px; /* Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø­Ø´ÙˆØ© Ø§Ù„Ø³ÙÙ„ÙŠØ© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            box-shadow: 0 -4px 20px rgba(0,0,0,0.08);
            z-index: 30;
            flex-shrink: 0;
            border-radius: 20px 20px 0 0;
        }
        
        .area-title { text-align:center; font-size:0.85rem; color:var(--text-muted); margin-bottom:12px; font-weight:700; }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
            gap: 12px;
        }

        .option-card {
            background: var(--surface);
            border: 1px solid #e2e8f0;
            border-bottom: 4px solid #cbd5e1;
            border-radius: 12px;
            padding: 15px 10px;
            text-align: center;
            font-size: 0.9rem; font-weight: 700; color: var(--text-main);
            cursor: pointer;
            min-height: 70px;
            display: grid; place-items: center;
            transition: transform 0.1s, border-color 0.2s, background 0.2s;
            user-select: none;
        }
        .option-card:active { transform: translateY(2px); border-bottom-width: 2px; background: #f1f5f9; }
        
        /* ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ… (Ù„Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±) */
        @media (hover: hover) {
            .option-card:hover {
                transform: translateY(-3px);
                border-bottom-color: var(--primary);
                color: var(--primary);
                box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
            }
        }

        /* --- ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (Desktop/Tablet) --- */
        @media (min-width: 768px) {
            .main-layout {
                flex-direction: row; /* ØªØ®Ø·ÙŠØ· Ø£ÙÙ‚ÙŠ */
                max-width: 1400px; margin: 0 auto; width: 100%;
            }
            .timeline-area {
                flex: 2; /* Ù…Ø³Ø§Ø­Ø© Ø£ÙƒØ¨Ø± Ù„Ù„Ø£Ø³Ø¦Ù„Ø© */
                padding: 40px;
                border-left: 1px solid #e2e8f0;
            }
            .cards-area {
                flex: 1; /* Ù…Ø³Ø§Ø­Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© Ù„Ù„Ø®ÙŠØ§Ø±Ø§Øª */
                border-top: none;
                border-radius: 0;
                background: #f8fafc;
                padding: 40px 20px;
                overflow-y: auto;
                box-shadow: -5px 0 15px rgba(0,0,0,0.03);
            }
            .cards-grid {
                grid-template-columns: 1fr; /* Ø¹Ù…ÙˆØ¯ ÙˆØ§Ø­Ø¯ Ù„Ù„Ø®ÙŠØ§Ø±Ø§Øª */
                gap: 20px;
            }
            .option-card {
                padding: 25px; font-size: 1.05rem;
                min-height: 90px;
            }
            
            /* ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø³ÙƒØ© ÙˆØ§Ù„Ù‚Ø·Ø§Ø± */
            .rail-track { height: 24px; width: 85%; }
            :root { --station-size: 70px; }
            #train-icon { font-size: 5rem; top: -65px; }
            .station { font-size: 1.6rem; border-width: 5px; }
        }

        /* --- Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Start/Win/Lose) --- */
        .overlay {
            position: fixed; inset: 0;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(8px);
            z-index: 100;
            display: none;
            justify-content: center; align-items: center;
            padding: 20px;
        }
        .overlay.active { display: flex; animation: fadeUp 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes fadeUp { from {opacity:0; transform:translateY(30px);} to {opacity:1; transform:translateY(0);} }

        .modal {
            background: white; width: 100%; max-width: 480px;
            border-radius: 24px; padding: 40px 30px;
            text-align: center; position: relative;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            border-top: 8px solid var(--secondary);
        }

        .btn-start {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white; border: none; padding: 18px 40px;
            border-radius: 50px; font-size: 1.1rem; font-weight: 800;
            cursor: pointer; margin-top: 25px; width: 100%;
            box-shadow: 0 10px 20px -5px rgba(0, 102, 51, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .btn-start:hover { transform: translateY(-3px); box-shadow: 0 15px 25px -5px rgba(0, 102, 51, 0.5); }
        .btn-start:active { transform: translateY(1px); }

        /* Toast Message */
        .toast {
            position: fixed; top: 15%; left: 50%; transform: translateX(-50%) scale(0.9);
            padding: 12px 30px; border-radius: 50px; color: white; font-weight: 700;
            z-index: 200; display: none; box-shadow: 0 15px 30px rgba(0,0,0,0.25);
            font-size: 1rem; white-space: nowrap; opacity: 0;
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        .toast.show { opacity: 1; transform: translateX(-50%) scale(1); }
    </style>
</head>
<body>

    <!-- Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ -->
    <div id="toast" class="toast"></div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
    <div id="start-screen" class="overlay active">
        <div class="modal">
            <div style="font-size: 4.5rem; margin-bottom: 15px;">ğŸš‚</div>
            <h1 style="color:var(--text-main); margin:0 0 10px; font-size: 2rem;">Ù‚Ø·Ø§Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ù„Ø§Ù„</h1>
            <p style="color:var(--text-muted); font-size: 1rem; margin-bottom: 25px;">
                Ø±Ø­Ù„Ø© ØªØ§Ø±ÙŠØ®ÙŠØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ø¹Ø¨Ø± Ø£Ø­Ø¯Ø§Ø« 11 Ø¯ÙŠØ³Ù…Ø¨Ø± 1960.
                <br>Ø±ØªØ¨ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„ØªØµÙ„ Ø¥Ù„Ù‰ Ù…Ø­Ø·Ø© Ø§Ù„Ø­Ø±ÙŠØ©!
            </p>
            
            <div style="background:#f1f5f9; padding:20px; border-radius:16px; text-align: right;">
                <ul style="margin:0; padding-right:20px; font-size:0.95rem; color:#475569; line-height: 1.8;">
                    <li>ğŸ¯ <strong>Ø§Ù„Ù‡Ø¯Ù:</strong> Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù‚Ø·Ø§Ø± Ù„Ù„Ù…Ø­Ø·Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©.</li>
                    <li>â¤ <strong>Ø§Ù„ÙØ±Øµ:</strong> Ù„Ø¯ÙŠÙƒ Ù…Ø­Ø§ÙˆÙ„ØªØ§Ù† ÙÙ‚Ø· Ù„ÙƒÙ„ Ù…Ø±Ø­Ù„Ø©.</li>
                    <li>ğŸ§  <strong>Ø§Ù„ØªØ­Ø¯ÙŠ:</strong> Ø±ØªØ¨ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« ÙˆØ£Ø¬Ø¨ Ø¨Ø°ÙƒØ§Ø¡.</li>
                </ul>
            </div>

            <button class="btn-start" onclick="Game.start()">Ø§Ù†Ø·Ù„Ø§Ù‚ Ø§Ù„Ø±Ø­Ù„Ø© ğŸš©</button>
        </div>
    </div>

    <!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div id="game-ui" style="display:none; flex-direction:column; height:100%;">
        
        <header>
            <div class="header-title">
                <h1>Ù‚Ø·Ø§Ø± Ø§Ù„Ø§Ø³ØªÙ‚Ù„Ø§Ù„</h1>
                <small>Ø°ÙƒØ±Ù‰ 11 Ø¯ÙŠØ³Ù…Ø¨Ø± 1960</small>
            </div>
            <div class="lives-box">
                <span style="color: #ef4444;">â¤</span> <span id="lives">2</span>
            </div>
        </header>

        <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù‚Ø·Ø§Ø± (Visual Train) -->
        <div class="train-container">
            <div class="rail-track">
                <div class="track-progress" id="track-fill"></div>
                
                <!-- Ø§Ù„Ù…Ø­Ø·Ø§Øª -->
                <div class="station" id="st-4" data-label="Ø§Ù„Ù†Ù‡Ø§ÙŠØ©">4</div>
                <div class="station" id="st-3" data-label="">3</div>
                <div class="station" id="st-2" data-label="">2</div>
                <div class="station active" id="st-1" data-label="Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©">1</div>
                
                <!-- Ø§Ù„Ù‚Ø·Ø§Ø± -->
                <div id="train-icon">ğŸš‚</div>
            </div>
            
            <!-- Ù†Øµ ØªÙˆØ¶ÙŠØ­ÙŠ Ø¨Ø³ÙŠØ· -->
            <div style="text-align:center; margin-top:25px; color:var(--text-muted); font-size:0.85rem; font-weight:600;">
                Ø§Ù„Ù…Ø­Ø·Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: <span id="current-stage-name" style="color:var(--primary);">Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø²Ù…Ù†ÙŠ</span>
            </div>
        </div>

        <div class="main-layout">
            <!-- Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Timeline) -->
            <div class="timeline-area">
                <div class="quest-card">
                    <div class="quest-header">
                        <span id="lvl-title" style="font-weight:800; font-size:1.2rem; color:var(--primary-dark);">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</span>
                        <span class="tag">Ù…Ù‡Ù…Ø© ØªØ§Ø±ÙŠØ®ÙŠØ©</span>
                    </div>
                    <p id="lvl-desc" style="color:var(--text-muted); font-size:1rem; line-height:1.6; margin:0;">Ø§Ù„ÙˆØµÙ</p>
                </div>
                <div id="slots-container" class="slots-wrapper">
                    <!-- ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø®Ø§Ù†Ø§Øª Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- Ù‚Ø³Ù… Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª (Cards) -->
            <div class="cards-area">
                <div class="area-title">ğŸ‘‡ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©</div>
                <div id="cards-container" class="cards-grid">
                    <!-- ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ù‡Ù†Ø§ -->
                </div>
            </div>
        </div>

    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ÙÙˆØ² -->
    <div id="win-screen" class="overlay">
        <div class="modal" style="border-top-color: var(--primary);">
            <div style="font-size:4.5rem; margin-bottom:15px;">ğŸ‡©ğŸ‡¿ğŸ‰</div>
            <h2 style="color:var(--primary); font-size: 1.8rem;">ÙˆØµÙ„ Ø§Ù„Ù‚Ø·Ø§Ø± Ø¨Ø³Ù„Ø§Ù…!</h2>
            <p style="color:#64748b; font-size: 1.1rem; margin-bottom: 25px;">
                Ù…Ø¨Ø±ÙˆÙƒ! Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø±Ø­Ù„Ø© Ø§Ù„Ø§Ø³ØªÙ‚Ù„Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ£Ø«Ø¨ØªØª Ù…Ø¹Ø±ÙØªÙƒ Ø¨ØªØ§Ø±ÙŠØ® Ø¨Ù„Ø§Ø¯Ùƒ.
            </p>
            <button class="btn-start" onclick="location.reload()">Ù„Ø¹Ø¨ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ â†º</button>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø®Ø³Ø§Ø±Ø© -->
    <div id="lose-screen" class="overlay">
        <div class="modal">
            <div style="font-size:4.5rem; margin-bottom:15px; filter:grayscale(1);">ğŸš‚</div>
            <h2 style="color:var(--secondary); font-size: 1.8rem;">ØªÙˆÙ‚Ù Ø§Ù„Ù‚Ø·Ø§Ø±!</h2>
            <p style="color:#64748b; font-size: 1.1rem; margin-bottom: 25px;">
                Ù„Ù„Ø£Ø³Ù Ù†ÙØ°Øª Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª. Ø±Ø§Ø¬Ø¹ Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© ÙˆØ­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.
            </p>
            <button class="btn-start" style="background:#475569;" onclick="location.reload()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© â†º</button>
        </div>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø§Ø­Ù„ (Ù…Ø·Ø§Ø¨Ù‚Ø© ØªÙ…Ø§Ù…Ø§Ù‹ Ù„Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©)
        const Levels = [
            {
                type: 'seq', title: "Ø§Ù„ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø²Ù…Ù†ÙŠ", desc: "Ø±ØªØ¨ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±Ø§Øª Ø­Ø³Ø¨ ØªÙˆØ§Ø±ÙŠØ®Ù‡Ø§:",
                slots: ["04 Ù†ÙˆÙÙ…Ø¨Ø± 1960", "09 Ø¯ÙŠØ³Ù…Ø¨Ø± 1960", "10 Ø¯ÙŠØ³Ù…Ø¨Ø± 1960", "11 Ø¯ÙŠØ³Ù…Ø¨Ø± 1960", "20 Ø¯ÙŠØ³Ù…Ø¨Ø± 1960"],
                ans: [1, 2, 3, 4, 5],
                items: [
                    {id:1, txt:"Ù…Ø´Ø±ÙˆØ¹ Ø¯ÙŠØºÙˆÙ„ 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø¬Ø²Ø§Ø¦Ø±ÙŠØ©'"}, {id:2, txt:"Ø§Ù†Ø·Ù„Ø§Ù‚ Ø§Ù„Ø´Ø±Ø§Ø±Ø© (Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª)"},
                    {id:3, txt:"Ø§ØªØ³Ø§Ø¹ Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±Ø§Øª (ÙˆÙ‡Ø±Ø§Ù†)"}, {id:4, txt:"Ø§Ù„Ø°Ø±ÙˆØ© ÙˆØ§Ù„Ù…Ø¹Ø±ÙƒØ© Ø§Ù„ÙØ§ØµÙ„Ø© (Ø§Ù„Ø¹Ø§ØµÙ…Ø©)"}, {id:5, txt:"Ø§Ù†ØªØµØ§Ø± Ø§Ù„Ù‚Ø¶ÙŠØ© ÙÙŠ Ø§Ù„Ø£Ù…Ù… Ø§Ù„Ù…ØªØ­Ø¯Ø©"}
                ]
            },
            {
                type: 'seq', title: "Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ", desc: "ÙƒÙŠÙ Ø§Ù†ØªÙ‚Ù„Øª Ø´Ø¹Ù„Ø© Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±Ø§Øª Ø¹Ø¨Ø± Ø§Ù„Ù…Ø¯Ù†ØŸ",
                slots: ["Ù†Ù‚Ø·Ø© Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚", "Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„", "Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø«Ø§Ù†ÙŠ", "Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø«Ø§Ù„Ø«", "Ø§Ù„ØªØ¹Ù…ÙŠÙ…"],
                ans: [1, 2, 3, 4, 5],
                items: [
                    {id:1, txt:"Ø¹ÙŠÙ† ØªÙ…ÙˆØ´Ù†Øª"}, {id:2, txt:"ØªÙ„Ù…Ø³Ø§Ù†"}, {id:3, txt:"ÙˆÙ‡Ø±Ø§Ù† (Ø§Ù„Ø­Ù…Ø±ÙŠ)"},
                    {id:4, txt:"Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± Ø§Ù„Ø¹Ø§ØµÙ…Ø© (Ø¨Ù„ÙƒÙˆØ± ÙˆØ§Ù„Ù‚ØµØ¨Ø©)"}, {id:5, txt:"Ø¨Ø§Ù‚ÙŠ ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„ÙˆØ·Ù†"}
                ]
            },
            {
                type: 'quiz', title: "Ø±Ù…ÙˆØ² Ø§Ù„Ø³ÙŠØ§Ø¯Ø©", desc: "Ø³Ø¤Ø§Ù„ Ø­ÙˆÙ„ Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„ØªÙŠ Ø±ÙØ¹Øª ÙÙŠ Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±Ø§Øª:",
                q: "Ù…Ø§ Ù‡Ùˆ Ø§Ù„Ø±Ù…Ø² Ø§Ù„Ø°ÙŠ Ø±ÙØ¹Ù‡ Ø§Ù„Ù…ØªØ¸Ø§Ù‡Ø±ÙˆÙ† Ù„Ø£ÙˆÙ„ Ù…Ø±Ø© Ø¨ÙƒØ«Ø§ÙØ© Ø£Ù…Ø§Ù… Ø§Ù„ØµØ­Ø§ÙØ© Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©ØŸ",
                ans: 'B',
                opts: [{id:'A', txt:"Ù„Ø§ÙØªØ§Øª Ø§Ù‚ØªØµØ§Ø¯ÙŠØ©"}, {id:'B', txt:"Ø§Ù„Ø¹Ù„Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ ğŸ‡©ğŸ‡¿"}, {id:'C', txt:"ØµÙˆØ± Ø§Ù„Ø¬Ù†Ø±Ø§Ù„ Ø¯ÙŠØºÙˆÙ„"}]
            },
            {
                type: 'seq', title: "Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù…Ø¸Ø§Ù‡Ø±Ø§Øª", desc: "Ø±ØªØ¨ Ø§Ù„Ø¢Ø«Ø§Ø± Ø§Ù„Ù…ØªØ±ØªØ¨Ø© Ø¹Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«:",
                slots: ["Ø³ÙŠØ§Ø³ÙŠØ§Ù‹ (Ø§Ù„Ø¯Ø§Ø®Ù„)", "Ø¹Ø³ÙƒØ±ÙŠØ§Ù‹", "Ø¯Ø¨Ù„ÙˆÙ…Ø§Ø³ÙŠØ§Ù‹ (Ø§Ù„Ø®Ø§Ø±Ø¬)", "Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ§Ù‹", "Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©"],
                ans: [1, 2, 3, 4, 5],
                items: [
                    {id:1, txt:"Ø³Ù‚ÙˆØ· Ø®Ø±Ø§ÙØ© 'Ø§Ù„Ø¬Ø²Ø§Ø¦Ø± ÙØ±Ù†Ø³ÙŠØ©'"}, {id:2, txt:"ÙÙƒ Ø§Ù„Ø®Ù†Ø§Ù‚ Ø¹Ù† Ø§Ù„Ø¬Ø¨Ø§Ù„"},
                    {id:3, txt:"ØªØ¯ÙˆÙŠÙ„ Ø§Ù„Ù‚Ø¶ÙŠØ© ÙˆØ§Ø¹ØªØ±Ø§Ù Ø§Ù„Ø£Ù…Ù… Ø§Ù„Ù…ØªØ­Ø¯Ø©"}, {id:4, txt:"Ø¥Ø¬Ø¨Ø§Ø± ÙØ±Ù†Ø³Ø§ Ø¹Ù„Ù‰ Ø§Ù„ØªÙØ§ÙˆØ¶"}, {id:5, txt:"Ø­ØªÙ…ÙŠØ© Ø§Ù„Ø§Ø³ØªÙ‚Ù„Ø§Ù„"}
                ]
            }
        ];

        const Game = {
            lvl: 0, step: 0, tries: 2,

            start() {
                document.getElementById('start-screen').classList.remove('active');
                const ui = document.getElementById('game-ui');
                ui.style.display = 'flex';
                this.load(0);
            },

            load(idx) {
                this.lvl = idx; this.step = 0; this.tries = 2;
                this.renderUI();
                this.updateTrainUI();
            },

            renderUI() {
                const data = Levels[this.lvl];
                document.getElementById('lvl-title').innerText = data.title;
                document.getElementById('lvl-desc').innerText = data.desc;
                document.getElementById('lives').innerText = this.tries;
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø£Ø³ÙÙ„ Ø§Ù„Ù‚Ø·Ø§Ø±
                document.getElementById('current-stage-name').innerText = data.title;

                const slotsCont = document.getElementById('slots-container');
                const cardsCont = document.getElementById('cards-container');
                slotsCont.innerHTML = ''; cardsCont.innerHTML = '';

                if(data.type === 'seq') {
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø§Ù†Ø§Øª
                    data.slots.forEach((label, i) => {
                        slotsCont.innerHTML += `
                        <div class="slot ${i===0?'active':''}" id="s-${i}">
                            <div class="slot-num">${i+1}</div>
                            <div class="slot-text" data-label="${label}">${label}</div>
                        </div>`;
                    });
                    // Ø®Ù„Ø· ÙˆØ¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
                    let arr = [...data.items].sort(()=>Math.random()-0.5);
                    arr.forEach(item => {
                        let div = document.createElement('div');
                        div.className = 'option-card'; div.innerText = item.txt;
                        div.onclick = (e) => this.check(item, e.target);
                        cardsCont.appendChild(div);
                    });
                    cardsCont.style.gridTemplateColumns = "1fr 1fr"; 
                } else {
                    // Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙˆÙŠØ²
                    slotsCont.innerHTML = `
                    <div class="slot active" style="padding:25px; height:auto; display:flex; justify-content:center; text-align:center; border-style:solid; border-color:var(--primary);">
                        <h3 style="margin:0; color:var(--text-main); font-size:1.1rem; line-height:1.6;">${data.q}</h3>
                    </div>`;
                    data.opts.forEach(opt => {
                        let div = document.createElement('div');
                        div.className = 'option-card'; div.innerText = opt.txt;
                        div.style.fontSize = "1.1rem"; // ØªÙƒØ¨ÙŠØ± Ø®Ø· Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ÙÙŠ Ø§Ù„ÙƒÙˆÙŠØ²
                        div.onclick = () => this.checkQuiz(opt.id);
                        cardsCont.appendChild(div);
                    });
                    cardsCont.style.gridTemplateColumns = "1fr";
                }
            },

            check(item, el) {
                const correct = Levels[this.lvl].ans[this.step];
                if(item.id === correct) {
                    this.showToast("Ø£Ø­Ø³Ù†Øª! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© âœ…", "success");
                    
                    const slot = document.getElementById(`s-${this.step}`);
                    slot.querySelector('.slot-text').innerText = item.txt;
                    slot.classList.remove('active'); slot.classList.add('filled');
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø¨ØªØ£Ø«ÙŠØ± Ø¨Ø³ÙŠØ·
                    el.style.transform = "scale(0.9)"; el.style.opacity = "0";
                    setTimeout(()=> el.style.visibility = 'hidden', 200);
                    
                    this.step++;
                    
                    if(this.step >= Levels[this.lvl].slots.length) {
                        setTimeout(() => this.nextLvl(), 800);
                    } else {
                        const nextSlot = document.getElementById(`s-${this.step}`);
                        if(nextSlot) {
                            nextSlot.classList.add('active');
                            nextSlot.scrollIntoView({behavior:'smooth', block:'center'});
                        }
                    }
                } else {
                    this.fail();
                }
            },

            checkQuiz(id) {
                if(id === Levels[this.lvl].ans) {
                    this.showToast("Ø¥Ø¬Ø§Ø¨Ø© Ø¯Ù‚ÙŠÙ‚Ø©! Ù…Ù…ØªØ§Ø² âœ…", "success");
                    setTimeout(() => this.nextLvl(), 800);
                } else {
                    this.fail();
                }
            },

            fail() {
                this.tries--;
                document.getElementById('lives').innerText = this.tries;
                this.showToast("Ø®Ø·Ø£! Ø­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ âŒ", "error");
                
                // Ø§Ù‡ØªØ²Ø§Ø² ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨
                const ui = document.getElementById('game-ui');
                ui.style.transform = "translateX(5px)";
                setTimeout(()=>ui.style.transform="translateX(-5px)", 50);
                setTimeout(()=>ui.style.transform="translateX(0)", 100);

                if(this.tries <= 0) {
                    setTimeout(() => {
                        document.getElementById('lose-screen').classList.add('active');
                    }, 500);
                }
            },

            nextLvl() {
                if(this.lvl < 3) this.load(this.lvl + 1);
                else {
                    this.lvl = 4;
                    this.updateTrainUI();
                    setTimeout(() => {
                        document.getElementById('win-screen').classList.add('active');
                    }, 1000);
                }
            },

            updateTrainUI() {
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
                let pct = this.lvl * 25;
                if(this.lvl === 4) pct = 100;

                document.getElementById('train-icon').style.right = pct + "%";
                document.getElementById('track-fill').style.width = pct + "%";

                for(let i=1; i<=4; i++) {
                    const st = document.getElementById(`st-${i}`);
                    st.className = 'station'; // reset classes
                    
                    if(i <= this.lvl) {
                        st.classList.add('passed');
                        st.innerHTML = "âœ”";
                    } else if(i === this.lvl + 1) {
                        st.classList.add('active');
                        st.innerHTML = i;
                    } else {
                        st.innerHTML = i;
                    }
                }
            },

            showToast(msg, type) {
                const t = document.getElementById('toast');
                t.innerText = msg;
                t.style.display = 'block';
                t.style.background = type === 'error' ? '#ef4444' : '#22c55e';
                
                // Trigger animation
                requestAnimationFrame(() => {
                    t.classList.add('show');
                });

                setTimeout(() => {
                    t.classList.remove('show');
                    setTimeout(() => t.style.display = 'none', 300);
                }, 2000);
            }
        };
    </script>
</body>
</html>